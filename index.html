<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆé¤åƒä»€éº¼ï¼Ÿ</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; text-align: center; background: #f0f2f5; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        /* è·‘é¦¬ç‡ˆé¡¯ç¤ºå€ */
        #display-box {
            font-size: 24px; font-weight: bold; color: #333;
            height: 60px; line-height: 60px;
            background: #e3e3e3; border-radius: 10px; margin-bottom: 20px;
            overflow: hidden; white-space: nowrap; text-overflow: ellipsis;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        button {
            padding: 15px 40px; font-size: 20px; cursor: pointer;
            background: #007bff; color: white; border: none; border-radius: 50px;
            transition: 0.3s;
        }
        button:hover { background: #0056b3; transform: scale(1.05); }
        button:disabled { background: #ccc; cursor: not-allowed; }

        /* çµæœé è¦½å€ */
        #result-area { margin-top: 20px; min-height: 300px; display: flex; align-items: center; justify-content: center; border: 2px dashed #ddd; border-radius: 10px; padding: 10px; }
        img { max-width: 100%; max-height: 600px; border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
        iframe { width: 100%; height: 600px; border: none; }
        
        /* Excel ä¸‹è¼‰å¡ç‰‡ */
        .excel-card { padding: 30px; background: #e8f5e9; border-radius: 10px; color: #2e7d32; }
        .excel-btn { display: inline-block; margin-top: 10px; padding: 10px 20px; background: #4caf50; color: white; text-decoration: none; border-radius: 5px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ± ä»Šå¤©åˆé¤åƒå“ªå®¶ï¼Ÿ</h1>
    
    <div id="display-box">æº–å‚™é–‹å§‹...</div>
    <button id="spinBtn" onclick="startSpin()">ğŸ² éš¨æ©Ÿé¸æ“‡</button>

    <div id="result-area">
        <p style="color: #888;">é»æ“ŠæŒ‰éˆ•é–‹å§‹æŠ½ç±¤ï¼Œçµæœå°‡é¡¯ç¤ºæ–¼æ­¤</p>
    </div>
</div>

<script src="list.js"></script>

<script>
    // æª¢æŸ¥æ¸…å–®æ˜¯å¦å­˜åœ¨
    if (typeof LUNCH_LIST === 'undefined' || LUNCH_LIST.length === 0) {
        document.getElementById('display-box').innerText = "âŒ å°šæœªè®€å–åˆ°æ¸…å–®ï¼Œè«‹ç¢ºèª list.js";
        document.querySelector('button').disabled = true;
    }

    function startSpin() {
        const display = document.getElementById('display-box');
        const resultArea = document.getElementById('result-area');
        const btn = document.getElementById('spinBtn');
        
        btn.disabled = true; // é˜²æ­¢é‡è¤‡é»æ“Š
        resultArea.innerHTML = '<p style="color:#888;">æŠ½ç±¤ä¸­...</p>';
        
        let count = 0;
        const totalSpins = 30; // è·³å‹•æ¬¡æ•¸
        const speed = 100;     // è·³å‹•é€Ÿåº¦(ms)

        // è·‘é¦¬ç‡ˆå‹•ç•«
        const interval = setInterval(() => {
            const randomName = LUNCH_LIST[Math.floor(Math.random() * LUNCH_LIST.length)];
            display.innerText = randomName;
            count++;

            if (count >= totalSpins) {
                clearInterval(interval);
                showResult(randomName);
                btn.disabled = false;
            }
        }, speed);
    }

    function showResult(fileName) {
        const resultArea = document.getElementById('result-area');
        const filePath = `./lunch_files/${encodeURIComponent(fileName)}`;
        const ext = fileName.split('.').pop().toLowerCase();

        let htmlContent = '';

        if (['jpg', 'jpeg', 'png', 'webp'].includes(ext)) {
            // åœ–ç‰‡
            htmlContent = `<img src="${filePath}" alt="${fileName}">`;
        } else if (ext === 'pdf') {
            // PDF (ä½¿ç”¨ iframe é è¦½)
            htmlContent = `<iframe src="${filePath}"></iframe>`;
        } else if (['xls', 'xlsx'].includes(ext)) {
            // Excel (æä¾›ä¸‹è¼‰æŒ‰éˆ•)
            htmlContent = `
                <div class="excel-card">
                    <h3>ğŸ“Š æŠ½ä¸­ Excel èœå–®</h3>
                    <p>${fileName}</p>
                    <a href="${filePath}" class="excel-btn" download>ğŸ“¥ ä¸‹è¼‰/é–‹å•Ÿèœå–®</a>
                    <p style="font-size:12px; margin-top:5px; color:#666;">Excel æª”æ¡ˆç„¡æ³•ç›´æ¥é è¦½ï¼Œè«‹ä¸‹è¼‰å¾Œé–‹å•Ÿ</p>
                </div>
            `;
        }

        resultArea.innerHTML = htmlContent;
    }
</script>

</body>
</html>